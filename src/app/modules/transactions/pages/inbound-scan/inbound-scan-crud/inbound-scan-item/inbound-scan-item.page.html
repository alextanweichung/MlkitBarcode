<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="previousStep()"><ion-icon slot="start" name="chevron-back-outline"></ion-icon>Back</ion-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button (click)="showPopover($event)"><ion-icon name="menu-outline" slot="icon-only"></ion-icon></ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-popover #popover [isOpen]="isPopoverOpen" (didDismiss)="isPopoverOpen = false">
  <ng-template>
    <ion-content class="p-2">
      <ion-list class="list-custom animate__animated animate__fadeIn" lines="full">
        <ion-item (click)="popover.dismiss()">
          <ion-label><div>Show Item List</div></ion-label>
          <ion-checkbox [(ngModel)]="showItemList"></ion-checkbox>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-popover>

<ion-content [fullscreen]="true">
  <div class="p-2">
    <app-barcode-scan-input #barcodescaninput (onItemAdd)="onItemAdd($event)" [itemVariationXMasterList]="objectService.itemVariationXMasterList" [itemVariationYMasterList]="objectService.itemVariationYMasterList"></app-barcode-scan-input>
    <input #barcodeInput class="p-2 mt-2 ion-flex ion-text-center" type="text" enterkeyhint="enter" [(ngModel)]="itemSearchValue" placeholder="Scan or Enter Item Barcode" (keydown)="handleKeyDown($event)">

    <ion-list class="list-custom animate__animated animate__fadeIn" lines="full" *ngIf="objectService.object.header.isWithDoc && showItemList">
      <ion-item button detail="false" class="ion-no-padding no-ripple">
        <ion-grid class="ion-no-padding py-2 pl-2">
          <ion-row>
            <ion-col size="6" class="ion-flex ion-margin-auto"><div class="font-bold">Item</div></ion-col>
            <ion-col class="ion-flex ion-margin-auto justify-content-end"><div class="font-bold">Doc Qty</div></ion-col>
            <ion-col class="ion-flex ion-margin-auto justify-content-end"><div class="font-bold">Scanned Qty</div></ion-col>
          </ion-row>
          <ion-row class="mt-1" *ngFor="let d of docDetailObject.outstandingScanList">
            <ion-col size="6" class="ion-flex ion-margin-auto">
              <div>{{d.itemCode}}</div>
              <span class="badge-green ion-text-wrap ion-flex my-auto px-1 mx-1" *ngIf="d.itemVariationXId"> {{d.itemVariationXDescription}}</span>
              <span class="badge-purple ion-text-wrap ion-flex my-auto px-1" *ngIf="d.itemVariationYId"> {{d.itemVariationYDescription}}</span>
            </ion-col>
            <ion-col class="ion-flex ion-margin-auto justify-content-end"><div>{{d.qtyRequest|number:'1.0'}}</div></ion-col>
            <ion-col class="ion-flex ion-margin-auto justify-content-end"><div>{{d.qtyScanned|number:'1.0'}}</div></ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list>

    <ion-list class="list-custom animate__animated animate__fadeIn mt-2" lines="full">
      <ion-item button detail="false" class="ion-no-padding no-ripple">
        <ion-grid class="ion-no-padding py-2 pl-2">
          <ion-row>
            <ion-col class="ion-flex ion-margin-auto"><div class="font-bold">Barcode</div></ion-col>
            <ion-col class="ion-flex ion-margin-auto"><div class="font-bold">Item Code</div></ion-col>
            <ion-col class="ion-flex ion-margin-auto justify-content-end"><div class="font-bold">Qty</div></ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>

      <ion-item-sliding #slidingItem *ngFor="let o of docDetailObject.currentScanList; let i = index">
        <ion-item button detail="false" class="ion-no-padding no-ripple" *ngIf="i >= 0">
          <ion-grid class="ion-no-padding py-2 pl-2">
            <ion-row>
              <ion-col class="ion-flex ion-margin-auto">{{o.itemBarcode}}</ion-col>
              <ion-col class="ion-flex ion-margin-auto">{{o.itemCode}}</ion-col>
              <ion-col class="ion-flex ion-margin-auto justify-content-end">{{o.qtyScanned}}</ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>
        <ion-item-options>
          <ion-item-option color="danger" (click)="slidingItem.close();"><ion-icon name="trash-outline"></ion-icon></ion-item-option>
        </ion-item-options>
      </ion-item-sliding>

    </ion-list>
  </div>
</ion-content>
